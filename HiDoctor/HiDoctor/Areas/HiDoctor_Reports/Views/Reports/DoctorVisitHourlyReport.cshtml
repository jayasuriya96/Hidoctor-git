

<script src="../../Scripts/Bootstrap/bootstrap.js?v=@HiDoctor.BuildNumber.BuildNo"></script>
<link href="../../Content/Bootstrap/bootstrap.css?v=@HiDoctor.BuildNumber.BuildNo" rel="stylesheet" />

<style>
    .dataTables_wrapper {
        min-height: 5px;
        padding-bottom: 5px;
    }

    table.display thead th {
        line-height: 14px;
        background: url(/Areas/HiDoctor_Activity/Content/images/Web/hd/thead.png) no-repeat;
    }

    
    .box {
        box-shadow: 1px 1px 1px rgb(204, 204, 204);
    }

    .hyperlink {
        color: blue;
        text-decoration: underline;
        cursor: pointer;
    }

   </style>

<link href="../areas/hidoctor_reports/content/reports.css" rel="stylesheet" />
<div class='col-xs-12'>
    <div class='col-xs-3 leftNav' id='leftNav'>
        <div id="tree" style="float: left; height: auto; width: 100%">
        </div>  
    <span id="spnTreeResize" onclick="fnTreeResize(this);"><i class="fa fa-chevron-circle-right fa-lg"></i></span>
        <div style="width: 1px;"></div>      
    </div>

    <div class='col-xs-9 rghtInputandRpt' float: left" id="divMain">
        <div style="display: none;" id="divToggle">
            <span id="spnTreeToggle" style="text-decoration: underline; cursor: pointer; padding: 5px"
                onclick="fnToggleTree()">Hide Tree</span> | <span id="spnInputToggle" style="text-decoration: underline; cursor: pointer; padding: 5px"
                    onclick="fnToggleInput()">Hide Input</span>
        </div>
        <div id="divInput" style="display: none; padding: 20px">
            @* <div class="helpIconright">
                <img src="~/Images/HelpIcon.png" onclick="fnHelp('USERPERDAYREPORT','PAGE')" />
            </div>*@
            <table>
                <tr>
                    <td>Select Start Date & End Date
                    </td>
                    <td>
                        <input type="text" id="txtFromDate" class='datepicker' readonly="readonly" />
                        <input type="text" id="txtToDate" class='datepicker' readonly="readonly" />
                        <input type="hidden" id="hdnUserCode" />
                        
                    </td>
                </tr>
                <tr>
                     <td>
                        <input type="radio" value="1" id="optViewInScreen" name="rptOptions" checked="checked" />
                        <label for="optViewInScreen">View in-screen</label>
                        <input type="radio" value="2" id="optExportToExcel" name="rptOptions" />
                        <label for="optExportToExcel">Export to excel</label>                   
                    </td>
                </tr>
                <tr>
                    <td colspan="2" align="center">
                        <input type="button" id="btnShow" name="Show" value="Show Report" onclick="fnDoctorVisitHourlyreport ();" />
                    </td>
                </tr>
            </table>
            <div id="dvloading" style="display: none">
                <img src="../../Content/images/loader1.gif" />
            </div>
         @*   <div id="dvTable" style="width: 100%; margin-left: 5px">
            </div>*@            
        </div>    
@* <div id="dvprint" onclick='fnprint("divuserperprint","ifrmuserperday");' title="print table" class="tabletools_button" style="background: url(../content/datatable/media/images/print.png) no-repeat center center; border: 1px solid #f0f0f0; height: 30px; width: 30px; cursor: pointer; float: right; margin-right: 4%;display:none"></div>
<br />*@
<div id="dvPrint" onclick='fnPrint("divuserperPrint","ifrmuserperday");' title="Print Table" class="TableTools_button" style="background: url(../Content/DataTable/media/images/print.png) no-repeat center center; border: 1px solid #f0f0f0; height: 30px; width: 30px; cursor: pointer; float: right; margin-right: 4%;display:none"></div>
<br />
          @*<div id="divReport">
            <div id="divSubReport"></div>
        </div>*@
<div></div>
        <div id="dvUserPerDayCont">
                </div>
      <div id="divdoctorvisithourly" style="padding-bottom: 5px; display: none">
            <div id="divPageHeader">
                <div id="dvLoading" style="display: none">
                    <img src="../Areas/HiDoctor_Activity/Content/images/Web/hd/loader.gif" />
                </div>
                <div id="dvUserPerDayCont">
                </div>
            </div>          
            </div>         

        </div>
        </div>
    </div>
</div>

<iframe id="ifrmPrint" style="height: 0px; width: 0px;"></iframe>
<div id="divPrint" style="display: none;"></div>
<iframe id="ifrmsubPrint" style="height: 0px; width: 0px;"></iframe>
<div id="divsubPrint" style="display: none;"></div>

<iframe id="ifrmuserperday" style="height: 0px; width: 0px;"></iframe>
<div id="divuserperPrint" style="display: none;"></div>

@*<div class="modal fade" id="myAttemptQuestDetail" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document" style="width: 900px;">
    <div class="modal-content">
      <div class="modal-header" style="border: none;">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body">
         <div class="col-sm-12" >
<div class="col-sm-12"><div class="col-sm-6">Doctor Name:</div><div class="col-sm-6" id="dvdoctorName"></div></div>
<div class="col-sm-12"><div class="col-sm-6">Address:</div><div class="col-sm-6" id="dvdoctorName"></div></div>
         </div> 
      </div>
      <div class="modal-footer" id="myAttemptQuestfooter">
        
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>*@


<script src="../../Areas/HiDoctor_Reports/Scripts/HD/DoctorVisitHourlyReport.js?v=@HiDoctor.BuildNumber.BuildNo" type="text/javascript"></script>
@*<script src="../../Areas/HiDoctor_Reports/Scripts/HD/UserPerDayNew12.6.11.js?v=@HiDoctor.BuildNumber.BuildNo" type="text/javascript"></script>*@
<script src="../../Areas/HiDoctor_Reports/Scripts/HD/ReportsCommonFiles.js?v=@HiDoctor.BuildNumber.BuildNo" type="text/javascript"></script>
@*<script src="~/Scripts/HD/DoctorVisitHourlyReport.js"></script>*@
<script type="text/javascript">    
    var currentUserCode_g ="";
    var treeExpandLevel = 0;
    var c_g;
    $(function () {
        $(".datepicker").datepicker({
            dateFormat: 'dd/mm/yy',
            numberOfMonths: 1
        });         
    });

    function fnClearDoctorVisitHourlyReport() {
        $("#txtFromDate").val('');
        $("#txtToDate").val('');
    }


    $(document).ready(function () {
            AjaxGlobalHandler.Initiate();
            try{
                $("#dvUserPerDayCont").html("");
                $("#dvUserPerDayCont").hide();
                // $("#divuserperday").hide();

                var userCode = @Html.Raw(Json.Encode(ViewBag.userCode)); 
                if(userCode==null)
                {
                    $("#leftNav").show();
                    var leftNav = $("#tree");
                    fnTreePosiition("tree");
                    currentUserCode_g = @Html.Raw(Json.Encode(ViewBag.cur_UserCode));
                    fnGetUserTreeByUser(currentUserCode_g, "dvUserTree", "dvFilteredNode");                
                    //fnDCRConsolidatedReport();
                    $('#dvPreviousNode').click(function () { fnBindUsersWithOneLevelParent(); });
                    $('#txtSearchNode').bind("keypress", function (e) {
                        if (e.keyCode == 13) {                       
                            fnSearchUsers();
                            return false;
                        }
                    });
                    $('#dvAjaxLoad').hide()   
                    $("#udvOverLay").overlay().load();
               
                }
                else{ // call from other pages.           
            
                    currentUserCode_g = userCode;
                    $("#dvTree").hide();   
                    $('#divInput').hide();
                    $('#divToggle').hide();
                    $("#dvAjaxLoad").hide();
               
                    var leftNav = $("#tree"); 
                    $("#leftNav").hide();
                    $("#divMain").addClass('col-xs-12');
                   
                    var DcrfromDate = @Html.Raw(Json.Encode(ViewBag.DcrfromDate)); 
                    var DcrEndDate = @Html.Raw(Json.Encode(ViewBag.DcrEndDate)); 
                    //var userName = @Html.Raw(Json.Encode(ViewBag.userName)); 

                    $("#txtFromDate").val(DcrfromDate);
                    $("#txtToDate").val(DcrEndDate);

                    $('#hdnUserCode').val(userCode);
                    $('#ddlflag').val(flag);
                    $('#hdnUserName').val(userName);
                   
                    $("#udvOverLay").overlay().load();
               
                    
                }            
            }
            catch (err) {
                $("#dvAjaxLoad").hide();
            }
        });

        function fnUserTreeNodeClick(node) {        
            $('#hdnUserCode').val(node.data.key);
            //$('#hdnUserName').val(node.data.title); 
            $('#divInput').show();
            $("#leftNav").show();
            $("#divMain").addClass('col-xs-9');
            // $("#divMain").css('width', '100%');
            $('#divToggle').show();
            $("#spnTreeToggle").html('Hide Tree');
            fnClearDoctorVisitHourlyReport();       
            //hide All dives       
            $("#aExpandCollapse").html("Collapse All");
            var objCol = $("#aExpandCollapse");  
            //fnDCRConsExpandCollapseAll(objCol);
            $("#aExpandCollapse").html("Collapse All");
            $("#dvUserPerDayCont").hide();
            // $("#divuserperday").hide();
            $("#dvPrint").hide();           
        }
    
        function fnUserTreePostInit() {

        }
  
        function fnToggleTree() {
            if ($("#spnTreeToggle").html() == "Hide Tree") {
                // $('#tree').hide();
                // $("#leftNav").hide();
                $('#tree').hide();  
                $('#leftNav').removeClass('col-xs-5');
                $('#leftNav').removeClass('col-xs-4');
                $('#leftNav').removeClass('col-xs-3');
                $("#divMain").removeClass('col-xs-9');
                $("#divMain").removeClass('col-xs-8');
                $("#divMain").removeClass('col-xs-7');
                $("#divMain").addClass('col-xs-12');            
                $("#spnTreeToggle").html('Show Tree');

                //Expand the Tree
                $('#spnTreeResize').attr('title', 'Click here to expand tree');
                $('#spnTreeResize').html('<i class="fa fa-chevron-circle-right fa-lg"></i>');
            }
            else if ($("#spnTreeToggle").html() == "Show Tree") {                    
                $('#tree').show();           
                $('#leftNav').addClass('col-xs-3');
                $('#divMain').removeClass('col-xs-7'); 
                $('#divMain').removeClass('col-xs-8'); 
                $('#divMain').removeClass('col-xs-9');   
                $("#divMain").addClass('col-xs-9');            
                $("#spnTreeToggle").html('Hide Tree');           
            }
        }
        function fnToggleInput() {
            if ($("#spnInputToggle").html() == "Hide Input") {
                $("#divInput").slideUp();
                $("#spnInputToggle").html("Show Input");
            }
            else if ($("#spnInputToggle").html() == "Show Input") {
                $("#spnInputToggle").html("Hide Input");
                $("#divInput").slideDown();

            }
        }
        function fnTreeResize(obj) {
            if (treeExpandLevel == 2) {
                treeExpandLevel = -1;
            }
            else {
                treeExpandLevel = parseInt(treeExpandLevel) + 1;
            }
            fnExpandCollapseUserTree(treeExpandLevel, 'leftNav', 'treeNav', obj, 'divMain', 'tree');
        }


</script>


